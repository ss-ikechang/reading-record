# 概要

## 本

- [マスタリングTCP/IP―入門編 | 井上 直也, 村山 公保, 竹下 隆史, 荒井 透, 苅田 幸雄](https://amzn.to/2VKrRbY)

## かかった時間

- xxx 時間

## 感想

- xxx

# 読書メモ

## 1: ネットワーク基礎知識

- コンピュータネットワーク登場の背景
  - スタンドアロンからネットワーク利用へ
    - スタンドアロン
      - コンピュータをネットワークに接続せず、単体で使用する状態
    - ネットワーク利用
      - 複数のコンピュータを互いに接続すると、個々のコンピュータに格納されている情報を複数のコンピュータの間で共有したり、遠くのコンピュータへ瞬時に送ったりできる
  - コンピュータ通信から情報通信環境へ
    - 初期のコンピュータネットワークは、管理者が指定した特定のコンピュータ同士を接続したもの
      - プライベートなネットワーク
    - これらの私的なネットワークを相互に接続することが活発になり、公共ネットワークとしてインターネットが利用されるようになる
- コンピュータとネットワーク発展の 7 つの段階
  - 1: バッチ処理
    - 処理するプログラムやデータをカードやテープに記録しておき、それを順番にコンピュータに読み込ませて一括処理する形式
  - 2: タイムシェアリングシステム(TSS)
    - 1960 年代に登場
    - 1 台のコンピュータに複数の端末を接続し、複数のユーザーが同時にコンピュータを利用できるようにしたシステム
  - 3: コンピュータ間通信
    - それまではコンピュータから別のコンピュータにデータを移したい時は、磁気テープやフロッピーディスクなどの外部記憶媒体にデータを一旦保存して、それを物理的に輸送しなければいけなかった
    - コンピュータ間の通信が可能になったことで、データを瞬時にやり取りできるようになった
  - 4: コンピュータネットワークの登場
    - 1980 年代になると、いろいろな種類のコンピュータを相互に接続できるコンピュータネットワークが登場した
    - ウィンドウシステム
      - コンピュータの画面上で複数の窓(ウィンドウ)を開くことのできるシステム
      - 複数のプログラムなどをウィンドウごとに割り付け、次々と切り替えて実行できる
  - 5: インターネットの普及
    - 1990 年代はじめには、情報処理に力を注ぐ企業や大学にて 1 人に 1 台ずつコンピュータが割り当てられ、ユーザーがコンピュータを専有して使用できる環境になってきた
    - 企業や一般家庭にインターネットが普及し始めた
  - 6: インターネット技術中心の時代へ
    - 電話網の代わりに、インターネットの技術でもある IP 網が用意され、その上で電話やテレビ放送、コンピュータ通信、インターネットが構築されるようになった
  - 7:「単につなぐ」時代から「安全につなぐ」時代へ
    - いまやインターネットは社会のインフラとして必須のものになった
    - 接続後の運用などを検討して十分な自己防衛を行い、安全で健全な通信手段として維持していくことが不可欠な時代
- プロトコルとは
  - ネットワークアーキテクチャ
    - 様々なプロトコルを体系的にまとめたもの
    - TCP/IP もネットワークアーキテクチャの 1 つで IP・TCP・HTTP などのプロトコルの集合体
  - プロトコル
    - コンピュータとコンピュータがネットワークを利用して通信するために決められた「約束ごと」
- プロトコルは誰が決める？
  - コンピュータ通信の登場から標準化へ
    - コンピュータ通信が始まった当初は、体系化や標準化が重要とは考えられていなかった
    - しかし、コンピュータの重要性が増し、多くの企業でコンピュータネットワークが導入されていくと、メーカーが違っても互いに通信できるような互換性が重要であると認識されるようになった
      - これがネットワークのオープン化、マルチベンダ化
  - プロトコルの標準化
    - ISO(International Organization for Standization: 国際標準化機構) は、国際標準として OSI(Open Systems Interconnection) と呼ばれる通信体系を標準化した
    - 現在 OSI の定めるプロトコルは普及していないが、OSI プロトコルを設計する際の指針として提唱された OSI 参照モデルはネットワークプロトコルを考える時によく引き合いに出される
    - TCP/IP は ISO の国際標準ではない。TCP/IP は IETF(Internet Engineering Task Force) で提案や標準化作業が行われているプロトコル
- プロトコルの階層化と OSI 参照モデル
  - プロトコルの階層化
    - OSI 参照モデルでは、通信に必要な機能を 7 つの階層に分け、機能を分割することで複雑になりがちなネットワークプロトコルを単純化する
    - 上位層と下位層の間でサービスのやり取りをする時の約束ごとを「インタフェース」と呼び、通信相手の同じ階層とやり取りをする時の約束ごとを「プロトコル」と呼ぶ
    - 各階層は、階層から特定のサービスを受け、上位層に特定のサービスを提供する
    - 利点
      - 階層化すると、各階層を独立なものとして扱うことができる
      - また、通信の機能分割が行われるため、それぞれの階層のプロトコルの実装が容易になり、それに伴って責任の分界点も明確になる
    - 欠点
      - モジュール化を進めすぎてしまうと、処理が重くなったり、各モジュールで似たような処理が必要になる場合がある
  - OSI 参照モデルの各層の役割
    - 7: アプリケーション層
      - 特定のアプリケーションに特化したプロトコル
    - 6: プレゼンテーション層
      - 機器固有のデータフォーマットと、ネットワーク共通のデータフォーマットの変換
      - データ形式に関する責任を持つ
    - 5: セッション層
      - 通信の管理
      - コネクションの確立・切断
    - 4: トランスポート層
      - 両端ノード間のデータ転送の管理
      - データを確実に相手に届ける役目
    - 3: ネットワーク層
      - アドレスの管理と経路の選択
    - 2: データリンク層
      - 直接接続された機器間でのデータフレームの識別と転送
      - 0 と 1 の数字の列を意味のあるかたまり(フレーム)に分けて、相手に伝える
    - 1: 物理層
      - 0 と 1 を電圧の高低や光の点滅に変換する
- 通信方式の種類
  - コネクション型とコネクションレス型
    - コネクション型
      - データの送信を開始する前に、送信ホストと受信ホストの間で回線の接続をする
      - 通信の前後にコネクションの確立と切断の処理を行う必要があるが、相手が通信不可能な場合には無駄なデータを送らずに済む
    - コネクションレス型
      - コネクションの確立や切断処理がない
      - 送信したいコンピュータはいつでもデータを送信できる。逆に受け取る側は、いつ誰からデータを受信するかわからない
        - そのため、データを受け取っていないかどうかを常に確認しなければならない
      - 通信相手がいるかどうかの確認を行わないため、受信相手がいない場合や、相手に届かない場合にもデータを送信できる
  - 回線交換とパケット交換
    - 現在のネットワークでは、大きく 2 つの通信方法が利用されている。回線交換とパケット交換である
    - 回線交換
      - 従来の電話で利用されてきた方式
      - 交換機がデータの中継処理をする。コンピュータは交換機に接続され、交換機間は複数の通信回線で接続される
      - 通信をしたい場合には目的のコンピュータとの間にコネクションを確立する。コネクションが切断されるまで、その回線は占有利用される
      - 回線を占有してしまうと、他のコンピュータはその回線を利用できないので、ユーザーの数が多くなると通信できなくなってしまう
    - パケット交換
      - 回線に接続しているコンピュータが送信するデータを複数の小包に分け、転送の順番を待つ行列に並べる方法が考え出された
      - データをパケットとして細分化することで、各コンピュータが一斉にデータを送受信できるようになり、回線を効率的に利用できる
  - 通信相手の数による通信方式の分類
    - ユニキャスト
      - 1 対 1 の通信
    - ブロードキャスト
      - 1 台のホストから接続される全てのホストへ向けて情報を発信する
    - マルチキャスト
      - ブロードキャストと同様に複数のホストへの通信を行うが、通信先を特定のグループに限定している
    - エニーキャスト(Anycast)
      - 1 台のホストから特定の複数のホストに向けて情報を発信する通信だが、マルチキャストとは振る舞いが異なる
      - 特定の複数台のうちからネットワーク上で最適な条件を持つ対象が 1 つ選別され、その対象 1 つにだけ送られる
- アドレスとは
  - 通信の主体、すなわち送信元と受信先は、「アドレス」によって特定される
  - アドレスの唯一性
    - 1 つのアドレスとして表される対象は明確に特定される必要があり、同じアドレスで表されるものが複数存在してはならない
  - アドレスの階層性
    - コンピュータ通信で用いる MAC アドレスと IP アドレスは、両方とも唯一性はあるが、階層性は IP アドレスだけにある
    - IP アドレスはネットワーク部とホスト部という 2 つの部分から構成され、ホスト部が異なる IP アドレスでも、同じネットワーク部を持つものは必ず同じ組織やグループに接続されている
    - ネットワークの途中にある通過点では、各パケットの宛先アドレスを見て、どのネットワークインタフェースから送り出すか決める
      - そのためにアドレスごとに送出インタフェースを記したテーブルを参照する
      - これは MAC アドレスでも IP アドレスでも同じ
        - MAC アドレスの場合は、このテーブルを転送表(フォワーディングテーブル)という
        - IP アドレスの場合は、このテーブルを経路制御表(ルーティングテーブル)という
        - 転送表には MAC アドレスがそのまま書かれるのに対し、経路制御表に書かれる IP アドレスは集約されたネットワーク部である
- ネットワークの構成要素
  - 通信媒体とデータリンク
    - データリンク
      - 直接接続された機器間で通信するためのプロトコルやネットワークを指す言葉
    - 例
      - データリンク名: イーサネット
      - 通信媒体
        - 同軸ケーブル: 伝送速度 10Mbps
        - ツイストペアケーブル: 伝送速度 10Mbps - 10Gbps
        - 光ファイバーケーブル: 伝送速度 10Mbps - 100Gbps
  - ネットワークインタフェース
    - コンピュータをネットワークに接続するには、ネットワークに接続するためのネットワークインタフェースが必要になる
    - このインタフェースは NIC(Network Interface Card)、ネットワークアダプタ、ネットワークカード、LAN カードと呼ばれる
  - リピーター
    - リピーターは OSI 参照モデルの第 1 層の物理層でネットワークを延長する機器
    - ケーブル上を流れてきた電気や光の信号を受信し、増幅や波形の整形などをしたのちに別の側へ再生する機器
    - リピーターによるネットワークの延長では、リピーターの接続段数に制限がある場合がある
      - 10Mbps のイーサネットでは最大 4 つのリピーターを多段接続できるが、100Mbps のイーサネットでは最大で 2 つのリピーターしか接続できない
    - 複数の線を収容できるリピーターもあり、リピーターハブと呼ばれる
  - ブリッジ / レイヤ 2 スイッチ
    - ブリッジは OSI 参照モデルの第 2 層、データリンク層でネットワーク同士を接続する装置
    - データリンクのフレームを認識してブリッジ内部のメモリにいったん蓄積し、接続された相手側のセグメントに新たなフレームとして送出する
    - データリンクのフレームには、フレームが正しく届いたかどうかをチェックするための FCS(Frame Check Sequence) と呼ばれるフィールドがある。ブリッジはこのフィールドをチェックして、壊れたフレームを他のセグメントへ送信しないようにする働きがある
    - セグメント
      - 分割、区分といった意味だが「ネットワーク」を指して使われる
  - ルーター / レイヤ 3 スイッチ
    - ルーターは OSI 参照モデルの第 3 層、ネットワーク層の処理を行う
    - ブリッジは物理アドレス(MAC アドレス)で処理を行うが、ルーターはネットワーク層のアドレスで処理を行う
      - TCP/IP でのネットワーク層のアドレスは IP アドレスになる
    - ルーターは異なるデータリンクを相互に接続できる
      - イーサネットとイーサネットを接続したり、イーサネットと FDDI を接続できる
  - レイヤ 4-7 スイッチ
    - レイヤ 4-7 スイッチは、OSI 参照モデルのトランスポート層からアプリケーション層の情報に基づいて配送処理を行う
    - 負荷分散を実現する方法の 1 つとして、Web サーバーの手前にロードバランサーというレイヤ 4-7 スイッチの一種を設置する場合がある
    - また、通信が混雑した場合などは音声通話のような即応性が求められる通信を優先し、メールやデータ転送といった多少遅延しても問題ない通信を後回しに処理することがある。このような処理を帯域制御と呼び、これもレイヤ 4-7 スイッチの機能の一部
  - ゲートウェイ
    - ゲートウェイとは、OSI 参照モデルのトランスポート層からアプリケーション層までの階層で、データを変換して中継する装置のこと
    - レイヤ 4-7 スイッチと同じく、トランスポート層以上の情報を見てパケットを処理しますが、ゲートウェイにはデータを中継するだけでなく、データを変換する役割がある
- 現在のネットワークの姿
  - 実際のネットワークの構成
    - 道路を例に説明する
    - 高速道路に相当するのが「コア(バックボーン)」
    - インターチェンジに相当する部分は「エッジ」
    - コンピュータネットワークでエッジへと接続されている部分を「アクセス(アグリゲーション)」

## 2: TCP/IP 基礎知識

- TCP/IP 登場の背景とその歴史
  - 軍事技術の応用から
    - 1960 年代、通信している途中にネットワークの一部が敵の攻撃によって破壊されても、迂回経路を通してデータが配送され、通信が停止しないようなネットワークが望まれた
    - パケット通信の必要性が唱えられるようになった
  - ARPANET の誕生
    - 1969 年、当初ネットワークは、アメリカ西海岸の大学と研究機関のうちの 4 つのノードを結んだものだった
      - パケット交換技術の実用性を試験するためのネットワーク
    - このネットワークは、一般のユーザーも取り込み大規模なネットワークに発達した
    - これが ARPANET と呼ばれるネットワークで、インターネットの期限と言われている
  - TCP/IP の誕生
    - ARPANET の実験では、信頼性の高い通信手段を提供する総合的な通信プロトコルの実験も行われた。そして 1970 年代前半に TCP/IP が開発された
    - その後、1982 年頃まで仕様が決定され、1983 年には ARPANET で使う唯一のプロトコルになった
  - UNIX の普及とインターネットの拡大
    - 1980 年前後の大学や研究所では、コンピュータの OS として BSD UNIX が広く利用された。この OS の内部に TCP/IP が実装された
    - 1980 年代は LAN が発達するとともに、UNIX ワークステーションの普及が急速に進んだ。同時に TCP/IP によるネットワークの構築が盛んに行われるようになった
    - TCP/IP による世界的なネットワークを「インターネット」と呼ぶようになったのはこの頃から
    - 1980 年代半ばごろからは、企業などを中心に導入が進んでいた各コンピュータメーカー独自のプロトコルも、次第に TCP/IP に対応するようになっていった
  - 商用インターネットサービスの開始
    - 1990 年代になると、企業や一般家庭に対してインターネットへの接続を提供するサービスが普及し、広く利用されるようになった。このようなサービスを提供する会社を ISP と呼ぶ
    - TCP/IP は研究ネットワークとしてインターネットで長い間運用されてきたことで、商用サービスにも耐えうる成熟したプロトコルになっていった
- TCP/IP の標準化
  - TCP/IP という言葉は TCP と IP という 2 つのプロトコルだけでなく、TCP や IP に関係する多くのプロトコルを含む
  - TCP/IP 標準化の精神
    - 他の標準化と比べると 2 つの点が大きく異なる
      - 1 つはオープンであること
      - もう 1 つは標準化するプロトコルが実際に使えるプロトコルであるかどうかを重視すること
        - 開発重視の姿勢でプロトコルが決められてきた
    - TCP/IP に比べて OSI が一般に普及しなかったのは、動作するプロトコルを早く作れなかったこと、急速な技術革新に対応できるようなプロトコルの決定や改良を行える仕組みがなかったこと
  - TCP/IP の仕様書 RFC
    - TCP/IP のプロトコルは、IETF で議論され標準化される。標準化しようとするプロトコルは、RFC(Request For Comments) と呼ばれるドキュメントになり、インターネット上で公開される
    - RFC になったドキュメントには番号が付けられ、IP は RFC791 で TCP は RFC793 で仕様を決められている。主要なプロトコルや標準に対しては、変化しない番号付けも行われている
  - TCP/IP プロトコルの標準化の流れ
    - 次のような段階を経る
      - 仕様を煮詰めるインターネットドラフト(ID: Internet-Draft)の段階
        - インターネットドラフトの有効期間は 6 ヶ月
      - 標準化したほうがよいと認められると RFC となり、提案標準(Proposed Standard)になる
      - そして標準の草案であるドラフト標準(Draft Standard)になる
      - 最後に標準(Standard)になる
    - 標準を決めてから普及させるような標準化団体とは根本的に考え方が違う。TCP/IP の世界では、標準になった時にはすでに十分に普及している
  - RFC の入手方法
    - [RFC Editor](https://www.rfc-editor.org/)
- インターネットの基礎知識
  - インターネットとは
    - 英語の internet はもともとは複数のネットワークを結んで 1 つのネットワークにすることを表していた
    - 現在インターネットというと、ARPANET から発展し、全正解を接続しているコンピュータネットワークのことを指す
  - インターネットと TCP/IP の関係
    - インターネットで通信するためにはプロトコルが必要
    - インターネットのプロトコルといえば TCP/IP で、TCP/IP といえばインターネットのプロトコル
  - ISP と地域ネット
    - インターネットに接続するためには、ISP や地域ネットに接続を依頼することになる
    - 会社や家庭のコンピュータをインターネットに接続する場合、インターネットへの接続契約を ISP との間で交わすことになる
- TCP/IP プロトコルの階層モデル
  - ハードウェア(物理層)
    - TCP/IP の階層モデルでは最下位層に物理的にデータを転送してくれるハードウェアを置いている
      - ハードウェアとは、イーサネットや電話回線などの物理層のこと
  - ネットワークインタフェース層(データリンク層)
    - ネットワークインタフェース層は、イーサネットなどのデータリンクを利用して通信するためのインタフェースとなる階層
      - NIC を動かすための「デバイスドライバ」と考えてよい
  - インターネット層(ネットワーク層)
    - インターネット層では IP プロトコルが使われる。IP プロトコルは IP アドレスをもとにして、パケットを転送する
    - TCP/IP の階層モデルでは、一般にこのインターネット層とトランスポート層がホストの OS に組み込まれることを想定している
    - 特にルーターには、インターネット層を利用してパケットを転送する機能を実装しないといけない
      - ブリッジやリピーター、ハブの場合は必ずしも IP や TCP を実装する必要はない
    - IP(Internet Protocol)
      - ネットワークをまたいでパケットを配送し、インターネット全体にパケットを送り届けるためのプロトコル
      - それぞれのホストを識別するために、IP アドレスと呼ばれる識別子を使う
    - ICMP(Internet Control Message Protocol)
      - IP パケットの配送中に何らかの異常が発生してパケットを転送できなくなった場合に、パケットの送信元に異常を知らせるために使われるプロトコル
    - ARP(Address Resolution Protocol)
      - パケットの送り先の物理的なアドレスを IP アドレスから取得するプロトコル
  - トランスポート層
    - トランスポート層の最も重要な役割はアプリケーションプログラム間の通信を実現すること
    - どのプログラムとどのプログラムが通信しているか識別する必要がある
      - ポート番号と呼ばれる識別子が使われる
    - TCP(Transmission Control Protocol)
      - TCP はコネクション型で信頼性のあるトランスポート層のプロトコル
      - ただし、コネクションの確立・切断をするだけで制御のためのパケットを約 7 回もやり取りするので、転送するデータの総量が少ない場合には無駄が多くなる
      - ネットワークの利用効率を向上させるための複雑な仕組みがいろいろと組み込まれているため、ビデオ会議の音声・映像データなどのように一定間隔で決められた量のデータを転送する通信にはあまり向いていない
    - UDP(User Datagram Protocol)
      - UDP は TCP とは異なり、コネクションレス型で信頼性のないトランスポート層プロトコル
      - UDP は送信したデータが相手に届いているかどうかの確認はしない
      - パケット数が少ない通信や、ブロードキャストやマルチキャストの通信、ビデオや音声などのマルチメディア通信に向いている
  - アプリケーション層(セッション層以上の上位層)
    - TCP/IP 階層モデルでは、OSI 参照モデルのセッション層やプレゼンテーション層、アプリケーション層はすべてアプリケーションプログラムの中で実現されると考えられている
    - TCP/IP のアプリケーションの多くは、クライアント / サーバーモデルで作られている
    - WWW(World Wide Web)
      - ブラウザとサーバーの間の通信で使われるプロトコルが HTTP
      - WWW では、HTTP が OSI 参照モデルのアプリケーション層のプロトコル、HTML がプレゼンテーション層のプロトコルといえる
    - 電子メール
      - 電子メールの配送では SMTP(Simple Mail Transfer Protocol) というプロトコルが利用される
      - 当初、インターネットの電子メールではテキスト形式でしかメッセージを送信できなかった。現在はデータ形式を拡張する MIME の仕様が一般的となり、映像や音声のファイルなど様々な情報を送れる
        - この MIME は OSI 参照モデルの第 6 層、プレゼンテーション層の機能といえる
    - ファイル転送(FTP: File Transfer Protocol)
      - ファイル転送とは、異なるコンピュータのハードディスク上に存在するファイルを自分のコンピュータのハードディスクに転送したり、あるいは自分のコンピュータのファイルを別のコンピュータへ移したりすること
      - ファイル転送のプロトコルとしては、FTP が古くから利用されている
    - 遠隔ログイン(TELNET と SSH)
      - 遠隔ログインとは、遠く離れたコンピュータにログインして、そのコンピュータでプログラムを走らせる機能
      - TCP/IP では、遠隔ログインでは、TELNET プロトコルや SSH プロトコルがよく用いられる
    - ネットワーク管理(SNMP: Simple Network Management Protocol)
      - TCP/IP では、ネットワーク管理に SNMP というプロトコルが利用される
      - SNMP で管理されるルーターやブリッジ、ホストなどはエージェントと呼ばれる。ネットワーク機器を管理するプログラムをマネージャと呼ぶ
      - SNMP はこのエージェントとマネージャの通信に使われるプロトコル
