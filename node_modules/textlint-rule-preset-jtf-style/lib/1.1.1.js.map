{"version":3,"sources":["../src/1.1.1.js"],"names":["module","exports","context","Syntax","RuleError","report","getSource","helper","RuleHelper","desumasuList","dearuList","reportResult","list","desumasu","dearu","forEach","node","matches","match","message","value","line","lineNumber","column","columnIndex","Document","Str","isChildNode","Link","Image","BlockQuote","Emphasis","ListItem","text","retDesumasu","length","push","retDearu","desumasuCount","reduce","count","dearuCount"],"mappings":"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","sourcesContent":["// LICENSE : MIT\n\"use strict\";\n/*\n1.1.1.本文\n\n本文の文体は、敬体(ですます調)あるいは常体(である調)のどちらかで統一します。\n敬体と常体を混在させないようにします。\n敬体と常体のどちらを使うかは、文書の目的や読み手に応じて決めます。\n\n 敬体(ですます調)\n一般読者向けの紹介文、パンフレット、マニュアル、ウェブサイトの本文では、基本的に「敬体」を使います。\n親しみやすい、柔らかい雰囲気で内容を伝えることができます。\n\n 常体(である調)\n常体は、簡潔に、力強い雰囲気で内容を伝えることができる文体です\n丁寧ではない印象を読み手に与える場合があるため、通常、一般向けのマニュアルの本文では使われません。\n */\nimport { analyzeDesumasu, analyzeDearu } from \"analyze-desumasu-dearu\";\nimport { RuleHelper } from \"textlint-rule-helper\";\nmodule.exports = function(context) {\n    let { Syntax, RuleError, report, getSource } = context;\n    let helper = new RuleHelper(context);\n    let desumasuList = [];\n    let dearuList = [];\n\n    function reportResult(list, { desumasu, dearu }) {\n        list.forEach(({ node, matches }) => {\n            matches.forEach(match => {\n                let message;\n                if (desumasu) {\n                    message = `本文を常体(である調)に統一して下さい。\\n本文の文体は、敬体(ですます調)あるいは常体(である調)のどちらかで統一します。\\n\"${\n                        match.value\n                    }\"が敬体(ですます調)です。`;\n                } else if (dearu) {\n                    message = `本文を敬体(ですます調)に統一して下さい。\\n本文の文体は、敬体(ですます調)あるいは常体(である調)のどちらかで統一します。\\n\"${\n                        match.value\n                    }\"が常体(である調)です。`;\n                }\n                report(\n                    node,\n                    new RuleError(message, {\n                        line: match.lineNumber - 1,\n                        column: match.columnIndex\n                    })\n                );\n            });\n        });\n    }\n\n    return {\n        [Syntax.Document]() {\n            desumasuList = [];\n            dearuList = [];\n        },\n        [Syntax.Str](node) {\n            // 本文以外は無視する\n            // => isUserWrittenNode\n            if (helper.isChildNode(node, [Syntax.Link, Syntax.Image, Syntax.BlockQuote, Syntax.Emphasis])) {\n                return;\n            }\n            // Listについては1.1.3. 箇条書きで扱う\n            if (helper.isChildNode(node, [Syntax.ListItem])) {\n                return;\n            }\n            let text = getSource(node);\n            let retDesumasu = analyzeDesumasu(text);\n            if (retDesumasu.length > 0) {\n                desumasuList.push({\n                    node: node,\n                    matches: retDesumasu\n                });\n            }\n            let retDearu = analyzeDearu(text);\n            if (retDearu.length > 0) {\n                dearuList.push({\n                    node: node,\n                    matches: retDearu\n                });\n            }\n        },\n        [`${Syntax.Document}:exit`]() {\n            let desumasuCount = desumasuList.reduce((count, { matches }) => count + matches.length, 0);\n            let dearuCount = dearuList.reduce((count, { matches }) => count + matches.length, 0);\n            if (desumasuCount === 0 || dearuCount === 0) {\n                return;\n            }\n            if (desumasuCount > dearuCount) {\n                reportResult(dearuList, { dearu: true });\n            } else if (desumasuCount < dearuCount) {\n                reportResult(desumasuList, { desumasu: true });\n            } else {\n                reportResult(dearuList, { dearu: true });\n            }\n        }\n    };\n};\n"],"file":"1.1.1.js"}